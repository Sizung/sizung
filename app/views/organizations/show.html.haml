%h3.conversation-index-header.hover-container
  = @organization
  .hover-display-inline
    %small
      = link_to edit_organization_path(@organization), class: 'organization-hover-action' do
        %i.fa.fa-pencil
        edit
      = link_to organization_organization_members_path(@organization), class: 'organization-hover-action' do
        %i.fa.fa-users
        members


%h4.conversation-index-header
  %i.fa.fa-comments
  Conversations

- @conversations.each do |conversation|
  .conversation
    .conversation-header
      = react_component('UnseenBadge', {count: conversation.unseen_objects.where(user: current_user).count, selected: false}, {prerender: true} )
      .conversation-title
        = link_to conversation.title, conversation, { data: { no_turbolink: true } }
      .conversation-actions
        = link_to edit_conversation_path(conversation) do
          %i.fa.fa-pencil
          edit
        = link_to conversation, method: :delete, data: { :confirm => 'Are you sure?' } do
          %i.fa.fa-trash-o
          delete
    .conversation-conversation-object
      - last_conversation_object = conversation.conversation_objects.first
      - if last_conversation_object
        .conversation-conversation-object-owner
          - user = last_conversation_object.owner
          = react_component('User', {user: {email: user.email, firstName: user.first_name, lastName: user.last_name}}, {prerender: true})
        .conversation-conversation-object-title
          = last_conversation_object.title
      - else
        .conversation-empty
          Jump right in and start the conversation.

%br

.organization-action
  = link_to new_organization_conversation_path(@organization) do
    %span.fa-stack.fa-lg
      %i.fa.fa-circle.fa-stack-2x
      %i.fa.fa-plus.fa-inverse.fa-stack-1x
    %span Add Conversation
